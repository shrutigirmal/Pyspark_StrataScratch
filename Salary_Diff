# Import your libraries
import pyspark
from  pyspark.sql import functions as F

joined_df=db_employee.join(db_dept,db_employee.department_id==db_dept.id,"inner")
filtered_df=joined_df.filter(F.col("department").isin("marketing","engineering"))
max_salary=filtered_df.groupBy().agg(F.max(F.when(db_dept.department=="marketing",db_employee.salary)).alias("max_m"),
F.max(F.when(db_dept.department=="engineering",db_employee.salary)).alias("max_e")
)

abs_salary=max_salary.withColumn("sal_diff", F.abs(max_salary.max_e - max_salary.max_m)).select('sal_diff')

abs_salary.toPandas()

